#!/usr/bin/env nodejs
// Import libraries
const bodyParser = require('body-parser'); // parse JSON requests
const compression = require('compression'); // compress file to GZIP
const cors = require('cors'); // CORS middleware
const csv = require('csvtojson'); // CSV parsing
const express = require('express');
const five9 = require('./helpers/five9-interface'); // Five9 interface helper functions
const fs = require('fs');
const helmet = require('helmet'); // security
const moment = require('moment'); // dates/times
const parseString = require('xml2js').parseString; // parse XML to JSON
const path = require('path');
const port = parseInt(process.env.PORT, 10) || 3000;
const secure = require('./secure_settings.js');

// Database handling
const mongoose = require('mongoose');
mongoose.Promise = global.Promise;
const report = require('./models/report');

// Initialize the app
const app = express();

// GZIP it up
app.use(compression());
// Allow CORS
app.use(cors());
// Serve static files
app.use(express.static(path.join(__dirname, 'public')));
// Parse JSON requests
app.use(bodyParser.json());
// And throw in some security middleware for good measure...
app.use(helmet());


// Five9 Statistics API request
app.post('/api/statistics', async (req, res) => {
    try {
        // Generate SOAP message for Five9
        const message = five9.jsonToSOAP(req.body, 'statistics');
        const auth = req.body['authorization'];

        // Send request to Five9
        let xmlData = await five9.sendRequest(message, auth, 'statistics');

        // On response, format as JSON and send back to client
        parseString(xmlData, (err, result) => {
            res.set('Content-Type', 'application/json');
            res.send(result);
        });
    } catch (err) {
        res.set('Content-Type', 'application/text');
        res.send('An error occurred on the server during POST.');
    }
});

// Five9 Configuration API requests
app.post('/api/configuration', async (req, res) => {
    try {
        // Generate SOAP message for Five9
        const message = five9.jsonToSOAP(req.body, 'configuration');
        const auth = req.body['authorization'];

        // Send request to Five9
        let xmlData = await five9.sendRequest(message, auth, 'configuration');

        // On response, format as CSV and send back to client
        parseString(xmlData, (err, result) => {
            res.set('Content-Type', 'text/csv');
            res.send(result);
        });
    } catch (err) {
        res.set('Content-Type', 'application/text');
        res.send('An error occurred on the server during POST.');
    }
});

// Return ZIP3 JSON
app.get('/api/zip3-data', async (req, res) => {
    try {
        // return JSON zip data
        let dir = path.join(__dirname + '/public/zip3-albers.json');
        res.sendFile(dir);
    } catch (err) {
        res.set('Content-Type', 'application/text');
        res.send('An error occurred on the server when getting zip3 data.');
    }
});

// Return U.S. states JSON
app.get('/api/states', async (req, res) => {
    try {
        // return JSON zip data
        let dir = path.join(__dirname + '/public/states-albers.json');
        res.sendFile(dir);
    } catch (err) {
        res.set('Content-Type', 'application/text');
        res.send('An error occurred on the server when getting U.S. states data.');
    }
});

// queue page
app.get('/', async (req, res) => {
    let dir = './public/index.html';
    let str = fs.readFileSync(path, 'utf-8');
    res.send(str);
});

// maps page
app.get('/maps', async (req, res) => {
    let dir = path.join(__dirname + '/public/maps.html');
    res.sendFile(dir);
});


// Fire up the server
let currentlyUpdatingData = false;
const server = app.listen(port, async () => {
    console.log(`Express listening on port ${port}!`);
    mongoose.connect('mongodb://localhost/five9-report-data');


    // Begin updating from Five9 every 2.5 minutes
    function scheduleUpdate(interval) {
        // setInterval(() => {
            currentlyUpdatingData = true;
            // update from Five9
            refreshDatabase(csvData);

            // Schedule next update
            currentlyUpdatingData = false;
            // scheduleUpdate(interval);
        // }, interval);
    }
    scheduleUpdate(2.5 * 60 * 1000);
});

// Update Five9 data
async function refreshDatabase(csvData) {
    // let data = five9.getReportResults();
    const time = {};
    time.start = moment().format('YYYY-MM-DD') + 'T00:00:00';
    time.end   = moment().format('YYYY-MM-DD') + 'T23:59:59';

    const data = [];


    // Remove all old data
    await report.Report.remove({}, (err, success) => {
        console.log('delete err: ' + err);
        console.log('delete success: ' + success);
    });

    // Get CSV data
    const reportParameters = five9.getParameters('runReport', null,
                        criteriaTimeStart=time.start, criteriaTimeEnd=time.end);
    var csvData = five9.getReportResults(reportParameters);
    console.log(csvData);
    return;
    const csvHeader = csvData.substr(0, csvData.indexOf('\n'));


    // Parse CSV data
    await new Promise((resolve, reject) => {
        csv( { delimiter: ',', headers: report.getHeadersFromCsv(csvHeader) } )
            .fromString(csvData)
            .on('json', (res) => {
                res.date = moment(res.date, 'YYYY/MM/DD').toDate();
                data.push(res);
                return resolve(data);
            }).on('error', reject);
        });

    // Insert the new data
    return report.Report.collection.insert(data, (err, docs) => {
        console.log('insert err: ' + err);
        return report.Report.collection.stats((err, results) => {
            console.log('stats err: ' + err);
            console.log('count: ' + results.count + '. size: ' + results.size + 'b');
        });
    });
}

module.exports = server;

let csvData = `DATE,SKILL,Global.strSugarZipCode,CALLS
2017/10/21,AQ_TS_SPRINGNET1,76648-4511,1
2017/10/21,AQ_TS_TELEBEEP,68643-4342,1
2017/10/21,TS_BUS_EMAIL_SUPPORT,,6
2017/10/21,TS_BUS_INTERNET,,7
2017/10/21,TS_BUS_INTERNET,57077-0000,1
2017/10/21,TS_BUS_INTERNET,76065-7724,1
2017/10/21,TS_BUS_INTERNET,77484-8155,1
2017/10/21,TS_BUS_INTERNET,77845-5509,1
2017/10/21,TS_BUS_INTERNET,79336-7516,1
2017/10/21,TS_BUS_INTERNET,80513-8902,1
2017/10/21,TS_OUTAGE,52501-8659,1
2017/10/21,TS_OUTAGE,74361-2951,1
2017/10/21,TS_RES_EMAIL_SUPPORT,,4
2017/10/21,TS_RES_EMAIL_SUPPORT,76226-4436,1
2017/10/21,TS_RES_EMAIL_SUPPORT,78161-4743,1
2017/10/21,TS_RES_EMAIL_SUPPORT,80863-2409,1
2017/10/21,TS_RES_EMAIL_SUPPORT,83201-3958,1
2017/10/21,TS_RES_EMAIL_SUPPORT,84062-8778,1
2017/10/21,TS_RES_EMAIL_SUPPORT,84310-9635,1
2017/10/21,TS_RES_INTERNET,,81
2017/10/21,TS_RES_INTERNET,50169-9748,1
2017/10/21,TS_RES_INTERNET,52531-8522,2
2017/10/21,TS_RES_INTERNET,53576-8780,1
2017/10/21,TS_RES_INTERNET,56083-4126,1
2017/10/21,TS_RES_INTERNET,56131-1302,1
2017/10/21,TS_RES_INTERNET,57069-6737,1
2017/10/21,TS_RES_INTERNET,60098-9139,1
2017/10/21,TS_RES_INTERNET,60111-0000,1
2017/10/21,TS_RES_INTERNET,60150-8529,1
2017/10/21,TS_RES_INTERNET,60152-9210,1
2017/10/21,TS_RES_INTERNET,60964-4711,1
2017/10/21,TS_RES_INTERNET,61313-9767,1
2017/10/21,TS_RES_INTERNET,61371-1012,1
2017/10/21,TS_RES_INTERNET,61802-9754,1
2017/10/21,TS_RES_INTERNET,61818-4308,1
2017/10/21,TS_RES_INTERNET,62514-0000,1
2017/10/21,TS_RES_INTERNET,62625-8815,1
2017/10/21,TS_RES_INTERNET,62673-7516,1
2017/10/21,TS_RES_INTERNET,68364-0000,1
2017/10/21,TS_RES_INTERNET,68601-8598,1
2017/10/21,TS_RES_INTERNET,68701-1210,1
2017/10/21,TS_RES_INTERNET,73018-7918,1
2017/10/21,TS_RES_INTERNET,73446-6673,1
2017/10/21,TS_RES_INTERNET,73449-5079,1
2017/10/21,TS_RES_INTERNET,73449-6555,1
2017/10/21,TS_RES_INTERNET,73533-2278,1
2017/10/21,TS_RES_INTERNET,74723-0000,1
2017/10/21,TS_RES_INTERNET,75009-4918,1
2017/10/21,TS_RES_INTERNET,75009-4977,1
2017/10/21,TS_RES_INTERNET,75021-4250,1
2017/10/21,TS_RES_INTERNET,75021-7525,2
2017/10/21,TS_RES_INTERNET,75110-8697,1
2017/10/21,TS_RES_INTERNET,75126-7604,1
2017/10/21,TS_RES_INTERNET,75146-0000,1
2017/10/21,TS_RES_INTERNET,75152-6011,1
2017/10/21,TS_RES_INTERNET,75164-0000,1
2017/10/21,TS_RES_INTERNET,75165-9533,1
2017/10/21,TS_RES_INTERNET,75165-9668,2
2017/10/21,TS_RES_INTERNET,75409-7449,1
2017/10/21,TS_RES_INTERNET,75413-0000,1
2017/10/21,TS_RES_INTERNET,75432-0000,1
2017/10/21,TS_RES_INTERNET,75442-5274,1
2017/10/21,TS_RES_INTERNET,75442-6560,1
2017/10/21,TS_RES_INTERNET,75452-6095,1
2017/10/21,TS_RES_INTERNET,75495-2971,1
2017/10/21,TS_RES_INTERNET,76009-4525,1
2017/10/21,TS_RES_INTERNET,76023-6028,1
2017/10/21,TS_RES_INTERNET,76028-0301,1
2017/10/21,TS_RES_INTERNET,76065-7505,1
2017/10/21,TS_RES_INTERNET,76066-3400,2
2017/10/21,TS_RES_INTERNET,76082-5042,1
2017/10/21,TS_RES_INTERNET,76082-5426,1
2017/10/21,TS_RES_INTERNET,76082-5900,1
2017/10/21,TS_RES_INTERNET,76084-3838,2
2017/10/21,TS_RES_INTERNET,76087-8972,1
2017/10/21,TS_RES_INTERNET,76088-2220,4
2017/10/21,TS_RES_INTERNET,76088-7621,1
2017/10/21,TS_RES_INTERNET,76227-4223,1
2017/10/21,TS_RES_INTERNET,76240-0000,1
2017/10/21,TS_RES_INTERNET,76245-4306,1
2017/10/21,TS_RES_INTERNET,76384-2772,1
2017/10/21,TS_RES_INTERNET,76633-4561,1
2017/10/21,TS_RES_INTERNET,76708-7067,2
2017/10/21,TS_RES_INTERNET,77406-9641,1
2017/10/21,TS_RES_INTERNET,77445-8254,1
2017/10/21,TS_RES_INTERNET,77845-2905,1
2017/10/21,TS_RES_INTERNET,78056-0000,1
2017/10/21,TS_RES_INTERNET,78069-3748,1
2017/10/21,TS_RES_INTERNET,78609-4487,1
2017/10/21,TS_RES_INTERNET,78609-4507,1
2017/10/21,TS_RES_INTERNET,79403-7120,2
2017/10/21,TS_RES_INTERNET,79416-0000,1
2017/10/21,TS_RES_INTERNET,79416-3516,1
2017/10/21,TS_RES_INTERNET,79423-6585,1
2017/10/21,TS_RES_INTERNET,80138-8561,1
2017/10/21,TS_RES_INTERNET,80420-0000,1
2017/10/21,TS_RES_INTERNET,80433-8104,1
2017/10/21,TS_RES_INTERNET,80433-8128,1
2017/10/21,TS_RES_INTERNET,80439-5504,1
2017/10/21,TS_RES_INTERNET,80440-0000,1
2017/10/21,TS_RES_INTERNET,80449-8594,1
2017/10/21,TS_RES_INTERNET,80503-9029,1
2017/10/21,TS_RES_INTERNET,80504-7708,1
2017/10/21,TS_RES_INTERNET,80513-8483,1
2017/10/21,TS_RES_INTERNET,80513-9663,1
2017/10/21,TS_RES_INTERNET,80514-8800,1
2017/10/21,TS_RES_INTERNET,80514-8805,2
2017/10/21,TS_RES_INTERNET,80516-2476,2
2017/10/21,TS_RES_INTERNET,80516-5417,1
2017/10/21,TS_RES_INTERNET,80516-7916,1
2017/10/21,TS_RES_INTERNET,80534-7432,1
2017/10/21,TS_RES_INTERNET,80537-9729,1
2017/10/21,TS_RES_INTERNET,80537-9739,1
2017/10/21,TS_RES_INTERNET,80550-3102,1
2017/10/21,TS_RES_INTERNET,80610-0000,1
2017/10/21,TS_RES_INTERNET,80624-9002,1
2017/10/21,TS_RES_INTERNET,80643-8301,1
2017/10/21,TS_RES_INTERNET,80831-7422,1
2017/10/21,TS_RES_INTERNET,80908-4214,1
2017/10/21,TS_RES_INTERNET,81413-8311,1
2017/10/21,TS_RES_INTERNET,81415-9170,1
2017/10/21,TS_RES_INTERNET,81650-9234,1
2017/10/21,TS_RES_INTERNET,81650-9651,1
2017/10/21,TS_RES_INTERNET,83201-3958,1
2017/10/21,TS_RES_INTERNET,83237-0000,2
2017/10/21,TS_RES_INTERNET,83263-5117,1
2017/10/21,TS_RES_INTERNET,83263-5236,1
2017/10/21,TS_RES_INTERNET,83263-5335,1
2017/10/21,TS_RES_INTERNET,83263-5476,1
2017/10/21,TS_RES_INTERNET,83401-3659,1
2017/10/21,TS_RES_INTERNET,83402-5256,1
2017/10/21,TS_RES_INTERNET,83402-5366,1
2017/10/21,TS_RES_INTERNET,83420-0000,1
2017/10/21,TS_RES_INTERNET,83434-5206,1
2017/10/21,TS_RES_INTERNET,83444-5135,1
2017/10/21,TS_RES_INTERNET,83676-5370,1
2017/10/21,TS_RES_INTERNET,83686-5886,1
2017/10/21,TS_RES_INTERNET,83686-9013,2
2017/10/21,TS_RES_INTERNET,83687-9015,1
2017/10/21,TS_RES_INTERNET,84029-5540,1
2017/10/21,TS_RES_INTERNET,84043-2385,2
2017/10/21,TS_RES_INTERNET,84081-3389,1
2017/10/21,TS_RES_INTERNET,84081-3883,1
2017/10/21,TS_RES_INTERNET,84081-3983,1
2017/10/21,TS_RES_INTERNET,84081-5399,1
2017/10/21,TS_RES_INTERNET,84084-6273,1
2017/10/21,TS_RES_INTERNET,84084-6901,1
2017/10/21,TS_RES_INTERNET,84088-0000,1
2017/10/21,TS_RES_INTERNET,84118-9327,1
2017/10/21,TS_RES_INTERNET,84128-3872,2
2017/10/21,TS_RES_INTERNET,84128-7031,1
2017/10/21,TS_RES_INTERNET,84129-0000,1
2017/10/21,TS_RES_INTERNET,84310-9538,1
2017/10/21,TS_RES_INTERNET,84310-9687,1
2017/10/21,TS_RES_INTERNET,84312-9331,1
2017/10/21,TS_RES_INTERNET,84325-0000,1
2017/10/21,TS_RES_INTERNET,84328-9002,1
2017/10/21,TS_RES_INTERNET,84339-9753,2
2017/10/21,TS_RES_INTERNET,84340-9318,1
2017/10/21,TS_RES_INTERNET,84404-9626,1
2017/10/21,TS_RES_INTERNET,84414-1110,1
2017/10/21,TS_RES_INTERNET,84414-1355,1
2017/10/21,TS_RES_INTERNET,84655-5108,1
2017/10/21,TS_RES_INTERNET,84660-4702,1
2017/10/21,TS_RES_INTERNET,89048-3530,1
2017/10/21,TS_RES_INTERNET,89048-5761,2
2017/10/21,TS_RES_INTERNET,89060-3833,1
2017/10/21,TS_RES_INTERNET,89801-4189,1
2017/10/21,TS_RES_INTERNET,89815-5224,1
2017/10/21,TS_RES_VOIP,,5
2017/10/21,TS_RES_VOIP,51040-8660,1
2017/10/21,TS_RES_VOIP,73449-6411,1
2017/10/21,TS_RES_VOIP,80117-8815,1
2017/10/21,TS_RES_VOIP,83201-4422,1
2017/10/21,TS_RES_VOIP,83686-8726,1
2017/10/21,TS_RES_VOIP,84049-6459,1
2017/10/21,TS_SPANISH,,7
2017/10/21,TS_SPANISH,60150-8306,1
2017/10/21,TS_SPANISH,78621-6439,1
2017/10/21,TS_SPANISH,80624-9002,2
2017/10/21,TS_SPANISH,83211-1266,2
2017/10/21,TS_SPANISH,83445-5511,2
2017/10/21,TS_SPANISH,84043-9792,4
2017/10/21,TS_SPANISH,84655-6003,5
2017/10/21,VENDOR_IB_TRANSFER_TS,,3
2017/10/21,VENDOR_XFER_RDI_TECH,,76
2017/10/21,VENDOR_XFER_RDI_TECH,50036-7486,2
2017/10/21,VENDOR_XFER_RDI_TECH,56131-1302,2
2017/10/21,VENDOR_XFER_RDI_TECH,57039-5719,2
2017/10/21,VENDOR_XFER_RDI_TECH,60033-9759,2
2017/10/21,VENDOR_XFER_RDI_TECH,61008-7320,2
2017/10/21,VENDOR_XFER_RDI_TECH,62642-9559,2
2017/10/21,VENDOR_XFER_RDI_TECH,68624-2408,2
2017/10/21,VENDOR_XFER_RDI_TECH,69101-8904,2
2017/10/21,VENDOR_XFER_RDI_TECH,69127-0000,2
2017/10/21,VENDOR_XFER_RDI_TECH,74730-4610,2
2017/10/21,VENDOR_XFER_RDI_TECH,74733-2822,2
2017/10/21,VENDOR_XFER_RDI_TECH,75021-5863,2
2017/10/21,VENDOR_XFER_RDI_TECH,75424-4732,2
2017/10/21,VENDOR_XFER_RDI_TECH,75449-0000,2
2017/10/21,VENDOR_XFER_RDI_TECH,76065-6202,2
2017/10/21,VENDOR_XFER_RDI_TECH,76082-5433,2
2017/10/21,VENDOR_XFER_RDI_TECH,76088-2007,2
2017/10/21,VENDOR_XFER_RDI_TECH,76251-1284,2
2017/10/21,VENDOR_XFER_RDI_TECH,76708-7067,2
2017/10/21,VENDOR_XFER_RDI_TECH,77845-6195,2
2017/10/21,VENDOR_XFER_RDI_TECH,77845-6448,2
2017/10/21,VENDOR_XFER_RDI_TECH,79316-7649,2
2017/10/21,VENDOR_XFER_RDI_TECH,79363-3936,2
2017/10/21,VENDOR_XFER_RDI_TECH,80026-9215,2
2017/10/21,VENDOR_XFER_RDI_TECH,80433-8121,4
2017/10/21,VENDOR_XFER_RDI_TECH,80433-8823,2
2017/10/21,VENDOR_XFER_RDI_TECH,80516-2476,2
2017/10/21,VENDOR_XFER_RDI_TECH,80537-8746,2
2017/10/21,VENDOR_XFER_RDI_TECH,80621-8233,2
2017/10/21,VENDOR_XFER_RDI_TECH,80651-9421,2
2017/10/21,VENDOR_XFER_RDI_TECH,81415-8701,2
2017/10/21,VENDOR_XFER_RDI_TECH,83202-2858,2
2017/10/21,VENDOR_XFER_RDI_TECH,83210-1732,2
2017/10/21,VENDOR_XFER_RDI_TECH,83221-5474,2
2017/10/21,VENDOR_XFER_RDI_TECH,83221-5733,2
2017/10/21,VENDOR_XFER_RDI_TECH,83402-5256,2
2017/10/21,VENDOR_XFER_RDI_TECH,83445-0000,2
2017/10/21,VENDOR_XFER_RDI_TECH,83676-0000,2
2017/10/21,VENDOR_XFER_RDI_TECH,83687-9015,2
2017/10/21,VENDOR_XFER_RDI_TECH,84043-2385,2
2017/10/21,VENDOR_XFER_RDI_TECH,84043-3465,2
2017/10/21,VENDOR_XFER_RDI_TECH,84081-1799,2
2017/10/21,VENDOR_XFER_RDI_TECH,84081-5715,2
2017/10/21,VENDOR_XFER_RDI_TECH,84084-6901,2
2017/10/21,VENDOR_XFER_RDI_TECH,84310-9687,2
2017/10/21,VENDOR_XFER_RDI_TECH,84404-9626,2
2017/10/21,VENDOR_XFER_TNI_TECH,,190
2017/10/21,VENDOR_XFER_TNI_TECH,50703-9509,2
2017/10/21,VENDOR_XFER_TNI_TECH,51040-8660,2
2017/10/21,VENDOR_XFER_TNI_TECH,53525-8637,2
2017/10/21,VENDOR_XFER_TNI_TECH,56083-4126,2
2017/10/21,VENDOR_XFER_TNI_TECH,56131-1302,2
2017/10/21,VENDOR_XFER_TNI_TECH,60033-9759,2
2017/10/21,VENDOR_XFER_TNI_TECH,60098-9139,2
2017/10/21,VENDOR_XFER_TNI_TECH,60111-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,60111-9501,2
2017/10/21,VENDOR_XFER_TNI_TECH,60152-8044,2
2017/10/21,VENDOR_XFER_TNI_TECH,61007-9747,4
2017/10/21,VENDOR_XFER_TNI_TECH,61039-9727,4
2017/10/21,VENDOR_XFER_TNI_TECH,61064-9020,2
2017/10/21,VENDOR_XFER_TNI_TECH,61064-9032,2
2017/10/21,VENDOR_XFER_TNI_TECH,61084-9715,2
2017/10/21,VENDOR_XFER_TNI_TECH,61101-2334,4
2017/10/21,VENDOR_XFER_TNI_TECH,61364-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,61379-9418,2
2017/10/21,VENDOR_XFER_TNI_TECH,62410-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,62642-9558,2
2017/10/21,VENDOR_XFER_TNI_TECH,62642-9559,2
2017/10/21,VENDOR_XFER_TNI_TECH,62852-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,62863-4045,4
2017/10/21,VENDOR_XFER_TNI_TECH,64836-5426,2
2017/10/21,VENDOR_XFER_TNI_TECH,73017-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,73449-5079,2
2017/10/21,VENDOR_XFER_TNI_TECH,73501-9289,4
2017/10/21,VENDOR_XFER_TNI_TECH,73533-2278,2
2017/10/21,VENDOR_XFER_TNI_TECH,73541-3653,2
2017/10/21,VENDOR_XFER_TNI_TECH,74330-3110,2
2017/10/21,VENDOR_XFER_TNI_TECH,74733-2822,2
2017/10/21,VENDOR_XFER_TNI_TECH,74868-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,75002-7912,4
2017/10/21,VENDOR_XFER_TNI_TECH,75009-4977,2
2017/10/21,VENDOR_XFER_TNI_TECH,75021-4094,2
2017/10/21,VENDOR_XFER_TNI_TECH,75021-7684,2
2017/10/21,VENDOR_XFER_TNI_TECH,75142-8747,2
2017/10/21,VENDOR_XFER_TNI_TECH,75152-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,75165-9668,2
2017/10/21,VENDOR_XFER_TNI_TECH,75167-8133,2
2017/10/21,VENDOR_XFER_TNI_TECH,75243-6352,2
2017/10/21,VENDOR_XFER_TNI_TECH,75401-7620,2
2017/10/21,VENDOR_XFER_TNI_TECH,75407-4814,2
2017/10/21,VENDOR_XFER_TNI_TECH,75409-6401,2
2017/10/21,VENDOR_XFER_TNI_TECH,75418-9043,2
2017/10/21,VENDOR_XFER_TNI_TECH,75449-0000,4
2017/10/21,VENDOR_XFER_TNI_TECH,75452-6095,2
2017/10/21,VENDOR_XFER_TNI_TECH,75454-3065,2
2017/10/21,VENDOR_XFER_TNI_TECH,75490-2820,2
2017/10/21,VENDOR_XFER_TNI_TECH,75491-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,75491-8760,2
2017/10/21,VENDOR_XFER_TNI_TECH,75492-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,75495-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,76008-4136,2
2017/10/21,VENDOR_XFER_TNI_TECH,76008-4704,2
2017/10/21,VENDOR_XFER_TNI_TECH,76009-8467,2
2017/10/21,VENDOR_XFER_TNI_TECH,76020-6039,2
2017/10/21,VENDOR_XFER_TNI_TECH,76067-1903,2
2017/10/21,VENDOR_XFER_TNI_TECH,76082-5433,2
2017/10/21,VENDOR_XFER_TNI_TECH,76082-5900,2
2017/10/21,VENDOR_XFER_TNI_TECH,76084-3838,4
2017/10/21,VENDOR_XFER_TNI_TECH,76087-1529,2
2017/10/21,VENDOR_XFER_TNI_TECH,76087-5510,2
2017/10/21,VENDOR_XFER_TNI_TECH,76107-2608,2
2017/10/21,VENDOR_XFER_TNI_TECH,76259-6171,2
2017/10/21,VENDOR_XFER_TNI_TECH,76264-2730,2
2017/10/21,VENDOR_XFER_TNI_TECH,76264-2790,2
2017/10/21,VENDOR_XFER_TNI_TECH,76266-4153,2
2017/10/21,VENDOR_XFER_TNI_TECH,76273-8343,2
2017/10/21,VENDOR_XFER_TNI_TECH,76574-5225,2
2017/10/21,VENDOR_XFER_TNI_TECH,76691-1223,2
2017/10/21,VENDOR_XFER_TNI_TECH,76692-3576,2
2017/10/21,VENDOR_XFER_TNI_TECH,76708-7059,2
2017/10/21,VENDOR_XFER_TNI_TECH,77406-9641,2
2017/10/21,VENDOR_XFER_TNI_TECH,77418-3067,2
2017/10/21,VENDOR_XFER_TNI_TECH,77418-3921,2
2017/10/21,VENDOR_XFER_TNI_TECH,77484-8155,2
2017/10/21,VENDOR_XFER_TNI_TECH,77485-9616,2
2017/10/21,VENDOR_XFER_TNI_TECH,77485-9632,2
2017/10/21,VENDOR_XFER_TNI_TECH,77523-2434,2
2017/10/21,VENDOR_XFER_TNI_TECH,77808-6133,2
2017/10/21,VENDOR_XFER_TNI_TECH,77808-7269,2
2017/10/21,VENDOR_XFER_TNI_TECH,77845-0000,4
2017/10/21,VENDOR_XFER_TNI_TECH,77845-2905,4
2017/10/21,VENDOR_XFER_TNI_TECH,77845-5519,2
2017/10/21,VENDOR_XFER_TNI_TECH,77859-3273,2
2017/10/21,VENDOR_XFER_TNI_TECH,78101-2312,2
2017/10/21,VENDOR_XFER_TNI_TECH,78114-6662,2
2017/10/21,VENDOR_XFER_TNI_TECH,78602-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,78605-3841,2
2017/10/21,VENDOR_XFER_TNI_TECH,78609-4487,4
2017/10/21,VENDOR_XFER_TNI_TECH,78611-5720,2
2017/10/21,VENDOR_XFER_TNI_TECH,78657-6352,2
2017/10/21,VENDOR_XFER_TNI_TECH,78662-9723,2
2017/10/21,VENDOR_XFER_TNI_TECH,79057-5632,2
2017/10/21,VENDOR_XFER_TNI_TECH,79415-4700,2
2017/10/21,VENDOR_XFER_TNI_TECH,80102-8304,2
2017/10/21,VENDOR_XFER_TNI_TECH,80106-9615,2
2017/10/21,VENDOR_XFER_TNI_TECH,80216-6601,2
2017/10/21,VENDOR_XFER_TNI_TECH,80433-0000,4
2017/10/21,VENDOR_XFER_TNI_TECH,80433-8121,2
2017/10/21,VENDOR_XFER_TNI_TECH,80439-5504,2
2017/10/21,VENDOR_XFER_TNI_TECH,80470-9732,2
2017/10/21,VENDOR_XFER_TNI_TECH,80504-3442,2
2017/10/21,VENDOR_XFER_TNI_TECH,80513-8668,2
2017/10/21,VENDOR_XFER_TNI_TECH,80513-9615,2
2017/10/21,VENDOR_XFER_TNI_TECH,80513-9663,8
2017/10/21,VENDOR_XFER_TNI_TECH,80537-9631,2
2017/10/21,VENDOR_XFER_TNI_TECH,80537-9729,6
2017/10/21,VENDOR_XFER_TNI_TECH,80538-9776,2
2017/10/21,VENDOR_XFER_TNI_TECH,80540-8831,2
2017/10/21,VENDOR_XFER_TNI_TECH,80603-8933,2
2017/10/21,VENDOR_XFER_TNI_TECH,80603-9707,2
2017/10/21,VENDOR_XFER_TNI_TECH,80624-9002,2
2017/10/21,VENDOR_XFER_TNI_TECH,80631-6336,2
2017/10/21,VENDOR_XFER_TNI_TECH,80631-9751,4
2017/10/21,VENDOR_XFER_TNI_TECH,80922-2603,2
2017/10/21,VENDOR_XFER_TNI_TECH,81413-8311,4
2017/10/21,VENDOR_XFER_TNI_TECH,81419-9693,4
2017/10/21,VENDOR_XFER_TNI_TECH,81623-1615,2
2017/10/21,VENDOR_XFER_TNI_TECH,83210-1732,2
2017/10/21,VENDOR_XFER_TNI_TECH,83221-2804,2
2017/10/21,VENDOR_XFER_TNI_TECH,83221-5279,2
2017/10/21,VENDOR_XFER_TNI_TECH,83221-9787,2
2017/10/21,VENDOR_XFER_TNI_TECH,83401-4706,2
2017/10/21,VENDOR_XFER_TNI_TECH,83402-5250,2
2017/10/21,VENDOR_XFER_TNI_TECH,83420-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,83420-5249,2
2017/10/21,VENDOR_XFER_TNI_TECH,83440-3224,2
2017/10/21,VENDOR_XFER_TNI_TECH,83442-5605,2
2017/10/21,VENDOR_XFER_TNI_TECH,83442-5958,4
2017/10/21,VENDOR_XFER_TNI_TECH,83444-5020,2
2017/10/21,VENDOR_XFER_TNI_TECH,83445-5704,2
2017/10/21,VENDOR_XFER_TNI_TECH,83445-5721,2
2017/10/21,VENDOR_XFER_TNI_TECH,83445-5736,4
2017/10/21,VENDOR_XFER_TNI_TECH,83617-9478,2
2017/10/21,VENDOR_XFER_TNI_TECH,83644-5327,2
2017/10/21,VENDOR_XFER_TNI_TECH,83676-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,83676-5370,4
2017/10/21,VENDOR_XFER_TNI_TECH,83686-8726,2
2017/10/21,VENDOR_XFER_TNI_TECH,83687-9015,6
2017/10/21,VENDOR_XFER_TNI_TECH,84004-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,84005-4393,2
2017/10/21,VENDOR_XFER_TNI_TECH,84005-5741,4
2017/10/21,VENDOR_XFER_TNI_TECH,84020-5310,2
2017/10/21,VENDOR_XFER_TNI_TECH,84029-5540,2
2017/10/21,VENDOR_XFER_TNI_TECH,84037-6852,2
2017/10/21,VENDOR_XFER_TNI_TECH,84043-2385,2
2017/10/21,VENDOR_XFER_TNI_TECH,84049-6459,2
2017/10/21,VENDOR_XFER_TNI_TECH,84062-4062,2
2017/10/21,VENDOR_XFER_TNI_TECH,84062-8547,2
2017/10/21,VENDOR_XFER_TNI_TECH,84081-1824,2
2017/10/21,VENDOR_XFER_TNI_TECH,84081-1849,2
2017/10/21,VENDOR_XFER_TNI_TECH,84081-1909,2
2017/10/21,VENDOR_XFER_TNI_TECH,84081-3400,2
2017/10/21,VENDOR_XFER_TNI_TECH,84081-3961,2
2017/10/21,VENDOR_XFER_TNI_TECH,84081-4101,2
2017/10/21,VENDOR_XFER_TNI_TECH,84081-5712,4
2017/10/21,VENDOR_XFER_TNI_TECH,84081-5714,2
2017/10/21,VENDOR_XFER_TNI_TECH,84088-2763,2
2017/10/21,VENDOR_XFER_TNI_TECH,84088-5469,2
2017/10/21,VENDOR_XFER_TNI_TECH,84092-3447,2
2017/10/21,VENDOR_XFER_TNI_TECH,84095-3255,2
2017/10/21,VENDOR_XFER_TNI_TECH,84118-6007,2
2017/10/21,VENDOR_XFER_TNI_TECH,84118-8245,2
2017/10/21,VENDOR_XFER_TNI_TECH,84118-9341,4
2017/10/21,VENDOR_XFER_TNI_TECH,84120-3149,2
2017/10/21,VENDOR_XFER_TNI_TECH,84128-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,84128-6410,2
2017/10/21,VENDOR_XFER_TNI_TECH,84320-1985,2
2017/10/21,VENDOR_XFER_TNI_TECH,84332-6716,2
2017/10/21,VENDOR_XFER_TNI_TECH,84332-9480,2
2017/10/21,VENDOR_XFER_TNI_TECH,84340-0000,4
2017/10/21,VENDOR_XFER_TNI_TECH,84340-8901,2
2017/10/21,VENDOR_XFER_TNI_TECH,84401-0000,2
2017/10/21,VENDOR_XFER_TNI_TECH,84655-5079,2
2017/10/21,VENDOR_XFER_TNI_TECH,84660-4702,2
2017/10/21,VENDOR_XFER_TNI_TECH,89048-2780,2
2017/10/21,VENDOR_XFER_TNI_TECH,89048-3530,2`;
